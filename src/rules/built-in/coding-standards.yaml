# 编码规范规则

id: coding-standards
name: 编码规范
description: 项目编码规范，所有角色必须遵守
version: "1.0.0"
enabled: true

category: coding
priority: 80

# 适用范围
appliesTo:
  - all

# 规则列表
rules:
  - id: naming-convention
    name: 命名规范
    description: 变量、函数、类命名必须遵循统一规范
    severity: warning
    pattern: |
      // 检查变量命名
      const [a-z][a-zA-Z0-9]*;
      function [a-z][a-zA-Z0-9]*;
      class [A-Z][a-zA-Z0-9]*;
    suggestion: "请使用有意义的命名，变量使用 camelCase，类使用 PascalCase"

  - id: no-console-log
    name: 生产环境禁止 console.log
    description: 生产代码中不应有 console.log
    severity: warning
    pattern: console\.(log|debug|info)
    suggestion: "请使用日志框架（如 logger）代替 console.log"
    example: "logger.info('message')"

  - id: error-handling
    name: 错误处理
    description: 所有异步操作必须有错误处理
    severity: error
    pattern: |
      // 检查 Promise 是否有 catch
      await.*\.then\([^)]*\)(?!\s*\.catch)
    suggestion: "请为异步操作添加错误处理"

  - id: no-any
    name: 禁止使用 any 类型
    description: 尽量避免使用 any 类型
    severity: warning
    pattern: ':\s*any\b'
    suggestion: "请使用具体的类型定义，或使用 unknown 代替"

  - id: no-magic-numbers
    name: 禁止魔法数字
    description: 不允许在代码中使用未解释的数字
    severity: warning
    pattern: '(?<![0-9.])[0-9]{2,}(?![0-9.])'
    suggestion: "请将魔法数字定义为常量"

  - id: prefer-const
    name: 优先使用 const
    - description: 不应修改的变量应使用 const
    severity: info
    pattern: 'let\s+[a-zA-Z_][a-zA-Z0-9_]*\s*=\s*[^=]*(?!.*\b(?:push|pop|splice|shift|unshift|reverse|sort)\b)'
    suggestion: "如果变量不会被重新赋值，请使用 const"

  - id: import-order
    name: import 排序
    description: import 语句应有规律的排序
    severity: info
    pattern: '^import.*from'
    suggestion: "请按照标准顺序组织 import 语句"

# 规则例外
exceptions:
  - id: test-files
    description: 测试文件可以使用 console 用于调试
    pattern: "**/*.test.ts"
    rules:
      - no-console-log

  - id: definition-files
    description: 类型定义文件可以使用 any
    pattern: "**/*.d.ts"
    rules:
      - no-any
