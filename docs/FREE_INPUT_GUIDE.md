# 自由输入使用指南

## 概述

Project Agent 的交互式会话现在支持**自由输入**！你可以直接用自然语言描述任务，系统会自动理解并调用相应的功能。

## 快速开始

### 启动自由输入会话

```bash
npm run chat
```

或者：

```typescript
import { createHybridModeManager } from 'agent-team';

const hybrid = createHybridModeManager(agent);
await hybrid.startInteractiveSession();
```

## 使用方式

### 方式 1：直接描述任务（推荐）

直接用自然语言描述你想做的事情，系统会自动识别任务类型：

```bash
# 功能开发
🤖 请输入你的任务或命令: 开发一个用户登录功能
🤖 请输入你的任务或命令: 实现数据验证模块
🤖 请输入你的任务或命令: 添加分页功能

# 代码编写
🤖 请输入你的任务或命令: 写一个快排算法
🤖 请输入你的任务或命令: 编写用户认证代码

# 代码审查
🤖 请输入你的任务或命令: 审查 src/auth 的代码
🤖 请输入你的任务或命令: 检查安全性问题
🤖 请输入你的任务或命令: 优化查询性能

# 编写测试
🤖 请输入你的任务或命令: 为登录功能编写测试
🤖 请输入你的任务或命令: 添加单元测试

# 编写文档
🤖 请输入你的任务或命令: 更新 API 文档
🤖 请输入你的任务或命令: 编写 README
```

### 方式 2：使用命令（精确控制）

使用 `/` 开头的命令可以更精确地控制操作：

```bash
# 功能开发
/feature 用户管理
/f 实现搜索功能

# 代码开发
/code 编写数据验证
/dev 实现接口

# 代码审查
/review ./src
/review 检查安全性

# 测试
/test 编写单元测试
/test 用户登录模块

# 文档
/doc API 文档
/doc README

# 其他命令
/stats        # 查看统计
/clear        # 清屏
/help         # 帮助
/exit         # 退出
```

## 支持的任务类型

系统会自动识别以下任务类型：

### 1. 功能开发

**关键词**：开发、实现、添加、新增、创建、功能

**示例**：
- "开发一个用户登录功能"
- "实现数据导出功能"
- "添加搜索功能"
- "创建管理后台"

**处理流程**：
1. 需求分析（产品经理）
2. 架构设计（架构师）
3. 代码开发（开发者）
4. 编写测试（测试工程师）
5. 更新文档（文档编写者）

### 2. 代码开发

**关键词**：写、写代码、代码、编程

**示例**：
- "写一个快排算法"
- "编写用户认证中间件"
- "实现单例模式"

**处理流程**：
- 直接进入代码开发阶段

### 3. 代码审查

**关键词**：审查、检查、优化、重构

**示例**：
- "审查 src/auth 目录"
- "检查代码安全性"
- "优化数据库查询"
- "重构用户模块"

**处理流程**：
- 执行代码审查任务

### 4. 编写测试

**关键词**：测试、单元测试

**示例**：
- "为用户登录编写测试"
- "添加 API 单元测试"
- "测试数据验证功能"

**处理流程**：
- 分配给测试工程师

### 5. 编写文档

**关键词**：文档、README

**示例**：
- "编写 API 文档"
- "更新 README"
- "添加使用说明"

**处理流程**：
- 分配给文档编写者

### 6. 需求分析

**关键词**：需求、分析

**示例**：
- "分析用户管理需求"
- "评估搜索功能需求"

**处理流程**：
- 分配给产品经理

### 7. 架构设计

**关键词**：架构、设计

**示例**：
- "设计系统架构"
- "规划数据库结构"

**处理流程**：
- 分配给架构师

## 完整示例

### 示例 1：功能开发

```bash
🤖 请输入你的任务或命令: 开发一个用户注册功能

系统会：
1. 识别任务类型: 功能开发
2. 显示任务描述
3. 询问是否执行
4. 自动完成：
   - 需求分析
   - 架构设计
   - 代码开发
   - 编写测试
   - 更新文档
```

### 示例 2：代码审查

```bash
🤖 请输入你的任务或命令: 审查 src/auth 的代码

系统会：
1. 识别任务类型: 代码审查
2. 显示任务信息
3. 询问是否执行
4. 执行代码审查
5. 显示审查结果
```

### 示例 3：使用命令

```bash
🤖 请输入你的任务或命令: /feature 用户登录

系统会：
1. 直接执行功能开发命令
2. 使用 "用户登录" 作为标题
```

## 常用命令

### 命令列表

| 命令 | 简写 | 说明 | 示例 |
|------|------|------|------|
| `/feature` | `/f` | 开发新功能 | `/feature 用户管理` |
| `/code` | `/dev` | 编写代码 | `/code 实现分页` |
| `/review` | - | 代码审查 | `/review ./src` |
| `/test` | - | 编写测试 | `/test 登录功能` |
| `/doc` | - | 编写文档 | `/doc API` |
| `/mode` | `/m` | 切换模式 | `/mode auto` |
| `/stats` | `/s` | 查看统计 | `/stats` |
| `/clear` | `/cls` | 清屏 | `/clear` |
| `/help` | `/h` | 帮助 | `/help` |
| `/exit` | `/q` | 退出 | `/exit` |

### 退出程序

可以使用以下任一方式退出：

```bash
exit
quit
再见
退出
/exit
/q
```

## 最佳实践

### 1. 清晰描述任务

✅ 好的描述：
- "开发一个支持邮箱和手机号登录的功能"
- "为用户管理模块添加分页和搜索功能"
- "审查认证模块的安全性，重点检查 SQL 注入"

❌ 不好的描述：
- "写个功能"
- "弄个登录"
- "看看代码"

### 2. 使用合适的任务类型

根据需求选择合适的表达方式：

```bash
# 如果需要完整的开发流程
"开发用户管理功能"  # → 完整流程：需求→设计→开发→测试→文档

# 如果只需要代码
"编写用户管理代码"  # → 直接进入开发

# 如果只需要审查
"审查用户管理代码"  # → 代码审查
```

### 3. 利用快捷命令

对于频繁操作，使用命令更高效：

```bash
# 快速开发
/f 用户管理        # 比 "开发用户管理功能" 更快

# 快速审查
/review ./src      # 比 "审查 src 目录的代码" 更快
```

## 技巧和窍门

### 1. 中英文混合支持

系统同时支持中英文输入：

```bash
# 中文
开发用户登录功能

# 英文
develop user login feature

# 混合
开发 user login 功能
```

### 2. 模糊匹配

即使不完全匹配关键词，系统也能理解：

```bash
"做个登录功能"      # → 功能开发
"写个登录的代码"    # → 代码开发
"检查一下登录"      # → 代码审查
```

### 3. 上下文理解

系统会根据描述内容选择最合适的执行方式：

```bash
"实现登录功能"      # → 功能开发（完整流程）
"写个登录接口"      # → 代码开发（直接编码）
"审查登录代码"      # → 代码审查
```

### 4. 多任务描述

可以在一次输入中描述多个需求：

```bash
"开发用户管理功能，支持增删改查，包含分页和搜索"

系统会：
1. 识别为核心功能开发
2. 提取多个需求：
   - 用户增删改查
   - 分页功能
   - 搜索功能
3. 完整执行开发流程
```

## 故障排除

### Q: 系统识别错了任务类型怎么办？

A: 使用命令精确指定：

```bash
# 系统识别成代码开发，但你想要完整功能开发
/feature 用户管理

# 系统识别成功能开发，但你只想写代码
/code 实现用户登录
```

### Q: 如何中断正在执行的任务？

A: 目前需要等待任务完成或使用 Ctrl+C（会退出程序）

### Q: 可以一次执行多个任务吗？

A: 可以描述多个需求，系统会整合成一个功能开发任务。如果要执行多个独立任务，需要逐个输入。

### Q: 中文和英文关键词都支持吗？

A: 是的！系统同时支持中英文，可以混合使用：

```bash
"开发 user login 功能"     # ✅ 支持
"实现 登录 feature"        # ✅ 支持
```

## 对比：自由输入 vs 命令

| 特性 | 自由输入 | 命令 |
|------|----------|------|
| 灵活性 | ⭐⭐⭐⭐⭐ | ⭐⭐⭐ |
| 精确性 | ⭐⭐⭐⭐ | ⭐⭐⭐⭐⭐ |
| 易用性 | ⭐⭐⭐⭐⭐ | ⭐⭐⭐⭐ |
| 学习成本 | 低 | 中 |
| 适用场景 | 日常使用 | 精确控制 |

**建议**：
- 日常使用自由输入，更自然高效
- 需要精确控制时使用命令

## 示例会话

```bash
$ npm run chat

═══════════════════════════════════════
  Project Agent 交互式会话
═══════════════════════════════════════

欢迎使用 Project Agent！这是一个基于角色的多智能体项目管理系统。

💡 使用提示:
  1. 直接描述你的任务，例如："开发用户登录功能"
  2. 使用命令（以 / 开头），例如："/help" 查看帮助
  3. 输入 "exit" 或 "再见" 退出程序


🤖 请输入你的任务或命令: 开发一个用户登录功能

### 理解任务...

任务类型: 功能开发
任务描述: 开发一个用户登录功能

是否执行此任务？ (y/N): y

✓ 正在开发功能...
✓ 任务完成！

### 生成的代码
function login(username, password) {
  // 实现登录逻辑
  ...
}

🤖 请输入你的任务或命令: 审查刚才的代码

### 理解任务...

任务类型: 代码审查
任务描述: 审查刚才的代码

是否执行此任务？ (y/N): y

✓ 正在审查代码...
✓ 任务完成！

### 审查结果
代码质量良好，建议添加...
```

## 总结

自由输入让 Project Agent 更加智能和易用：

- ✅ **自然语言交互** - 像与人对话一样简单
- ✅ **智能识别** - 自动理解任务类型
- ✅ **灵活切换** - 支持中英文混合
- ✅ **命令支持** - 保留精确控制能力
- ✅ **上下文理解** - 根据描述选择最佳执行方式

试试看吧！`npm run chat` 🚀
