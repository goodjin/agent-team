# 任务清单

## 项目结构

```
tasks/
├── 1.user-interface/          # 用户接口层
│   └── 1.1-server/            # Web 服务器
│       ├── TASK-1.1.1.md      # Express 服务器基础架构
│       ├── TASK-1.1.2.md      # REST API 路由实现
│       ├── TASK-1.1.3.md      # 任务管理 API 路由
│       └── TASK-1.1.4.md      # 角色和智能体 API 路由
│
├── 2.application/             # 应用层
│   └── 2.1-core/              # 核心系统
│       ├── TASK-2.1.1.md      # TaskManager 任务管理模块
│       ├── TASK-2.1.2.md      # AgentMgr 智能体管理模块
│       ├── TASK-2.1.3.md      # EventSystem 事件系统
│       └── TASK-2.1.4.md      # ProjectAgent 主入口
│
├── 3.domain/                  # 领域层
│   ├── 3.1-ai/                # AI Agent 核心逻辑
│   │   ├── TASK-3.1.1.md      # AI Agent 核心逻辑
│   │   └── TASK-3.1.2.md      # Checkpoint 断点管理器
│   │
│   ├── 3.2-roles/             # 角色提示词管理
│   │   └── TASK-3.2.1.md      # RoleManager 角色提示词管理器
│   │
│   └── 3.3-rules/             # 规则文件管理
│       └── TASK-3.3.1.md      # RuleManager 规则管理器
│
└── 4.infrastructure/          # 基础设施层
    ├── 4.1-llm/               # LLM 服务
    │   ├── TASK-4.1.1.md      # LLMService 服务层
    │   └── TASK-4.1.2.md      # LLM 适配器层
    │
    ├── 4.2-tools/             # 工具系统
    │   ├── TASK-4.2.1.md      # ToolRegistry 工具注册表
    │   ├── TASK-4.2.2.md      # 文件操作工具
    │   ├── TASK-4.2.3.md      # Git 工具
    │   ├── 4.2.4-ai-generation/TASK-4.2.4.md  # AI 生成工具
    │   ├── 4.2.5-browser/TASK-4.2.5.md        # 浏览器工具
    │   └── 4.2.6-code-analysis/TASK-4.2.6.md  # 代码分析工具
    │
    ├── 4.3-config/            # 配置管理
    │   ├── TASK-4.3.1.md      # 配置管理器实现
    │   └── 4.3.2-startup/TASK-4.3.2.md  # 启动脚本和守护进程
    │
    ├── 4.4-types/             # 类型定义
    │   └── TASK-4.4.1.md      # 类型定义基础
    │
    └── 4.5-utils/             # 工具函数
        └── TASK-4.5.1.md      # 文件工具函数
```

## 执行顺序建议

### 第一阶段：基础设施层（优先级高）

1. **4.4.1 类型定义基础** - 先定义所有类型
2. **4.5.1 文件工具函数** - 基础工具依赖
3. **4.3.1 配置管理器实现** - 配置加载
4. **4.1.1 LLMService 服务层** - LLM 调用
5. **4.1.2 LLM 适配器层** - 多服务商适配
6. **4.2.1 ToolRegistry 工具注册表** - 工具管理
7. **4.2.2 文件操作工具** - 基础工具实现
8. **4.2.3 Git 工具** - Git 操作工具

### 第二阶段：领域层

9. **3.2.1 RoleManager 角色提示词管理器** - 角色管理
10. **3.3.1 RuleManager 规则管理器** - 规则管理
11. **3.1.2 Checkpoint 断点管理器** - 断点恢复
12. **3.1.1 AI Agent 核心逻辑** - Agent 执行

### 第三阶段：应用层

13. **2.1.3 EventSystem 事件系统** - 事件机制
14. **2.1.1 TaskManager 任务管理模块** - 任务管理
15. **2.1.2 AgentMgr 智能体管理模块** - 智能体管理
16. **2.1.4 ProjectAgent 主入口** - 主入口协调

### 第四阶段：用户接口层

17. **1.1.1 Express 服务器基础架构** - 服务器基础
18. **1.1.2 REST API 路由实现** - 项目 API
19. **1.1.3 任务管理 API 路由** - 任务 API
20. **1.1.4 角色和智能体 API 路由** - 角色/智能体 API

### 第五阶段：后续工具和启动

21. **4.2.4 AI 生成工具** - 文生图、文生视频等
22. **4.2.5 浏览器工具** - 网页浏览、搜索、交互
23. **4.2.6 代码分析工具** - 代码分析、差异对比
24. **4.3.2 启动脚本和守护进程** - 系统启动、守护进程

## 任务统计

| 层级 | 模块数 | 任务数 |
|------|--------|--------|
| 用户接口层 | 1 | 4 |
| 应用层 | 1 | 4 |
| 领域层 | 3 | 4 |
| 基础设施层 | 5 | 12 |
| **总计** | **10** | **24** |

## 依赖关系图

```
4.4.1 ─┬─► 4.5.1 ──► 4.3.1 ──► 4.1.1 ──► 4.1.2
       │            │
       │            └─► 4.2.1 ──► 4.2.2 ──► 4.2.3
       │                      │           │
       │                      │           └─► 4.2.4
       │                      │
       │                      └─► 4.2.5, 4.2.6
       │
       └────────────────────────► 3.2.1 ──► 3.3.1
                                 │
                                 └─► 3.1.2 ──► 3.1.1
                                           │
                                           └─► 2.1.3 ──► 2.1.1
                                                     │
                                                     └─► 2.1.2 ──► 2.1.4
                                                               │
                                                               └─► 1.1.1 ──► 1.1.2
                                                                         │
                                                                         └─► 1.1.3 ──► 1.1.4
                                                                           │
                                                                           └─► 4.3.2
```

## 任务编号规则

任务编号采用 `X.Y.Z` 格式：
- **X**: 分层编号（1-用户接口层, 2-应用层, 3-领域层, 4-基础设施层）
- **Y**: 模块编号
- **Z**: 任务序号

例如：`1.1.2` 表示用户接口层第1个模块（server）的第2个任务（REST API 路由实现）

## 任务详情索引

| 编号 | 任务名称 | 优先级 | 工时 |
|------|----------|--------|------|
| 1.1.1 | Express 服务器基础架构 | 高 | 2h |
| 1.1.2 | REST API 路由实现 | 高 | 3h |
| 1.1.3 | 任务管理 API 路由 | 高 | 3h |
| 1.1.4 | 角色和智能体 API 路由 | 中 | 3h |
| 2.1.1 | TaskManager 任务管理模块 | 高 | 4h |
| 2.1.2 | AgentMgr 智能体管理模块 | 高 | 3h |
| 2.1.3 | EventSystem 事件系统 | 中 | 2h |
| 2.1.4 | ProjectAgent 主入口 | 高 | 3h |
| 3.1.1 | AI Agent 核心逻辑 | 高 | 4h |
| 3.1.2 | Checkpoint 断点管理器 | 高 | 3h |
| 3.2.1 | RoleManager 角色提示词管理器 | 高 | 2h |
| 3.3.1 | RuleManager 规则管理器 | 中 | 2h |
| 4.1.1 | LLMService 服务层 | 高 | 4h |
| 4.1.2 | LLM 适配器层 | 高 | 6h |
| 4.2.1 | ToolRegistry 工具注册表 | 高 | 3h |
| 4.2.2 | 文件操作工具 | 高 | 3h |
| 4.2.3 | Git 工具 | 中 | 3h |
| 4.2.4 | AI 生成工具 | 中 | 4h |
| 4.2.5 | 浏览器工具 | 中 | 4h |
| 4.2.6 | 代码分析工具 | 低 | 3h |
| 4.3.1 | 配置管理器实现 | 高 | 2h |
| 4.3.2 | 启动脚本和守护进程 | 高 | 3h |
| 4.4.1 | 类型定义基础 | 高 | 1h |
| 4.5.1 | 文件工具函数 | 高 | 1h |

**总计工时**: 约 67 小时
